

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial Kinetic Analysis &mdash; Aqua 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Aqua 0.1 documentation" href="index.html" />
    <link rel="next" title="Berezovska2012" href="tutorial_berezovska2012.html" />
    <link rel="prev" title="Tutorial Networks" href="tutorial_networks.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.gif" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_berezovska2012.html" title="Berezovska2012"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_networks.html" title="Tutorial Networks"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.gif" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial Kinetic Analysis</a><ul>
<li><a class="reference internal" href="#d-trajectories">1D Trajectories</a><ul>
<li><a class="reference internal" href="#loading-a-trajectory">Loading a trajectory</a></li>
<li><a class="reference internal" href="#first-order-kinetic-model">First order kinetic model</a></li>
<li><a class="reference internal" href="#life-time-distribution">Life time distribution</a></li>
<li><a class="reference internal" href="#first-passage-time-distribution">First Passage Time distribution</a></li>
<li><a class="reference internal" href="#first-committed-passage-time-distribution">First Committed Passage Time distribution</a></li>
<li><a class="reference internal" href="#trip-time-distribution">Trip Time distribution</a></li>
<li><a class="reference internal" href="#committed-trip-time-distribution">Committed Trip Time distribution</a></li>
<li><a class="reference internal" href="#accurate-kinetic-decomposition">Accurate kinetic decomposition</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial_networks.html"
                        title="previous chapter">Tutorial Networks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorial_berezovska2012.html"
                        title="next chapter">Berezovska2012</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial_kinetic_analysis.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial-kinetic-analysis">
<span id="tutorial-kin-anal"></span><h1>Tutorial Kinetic Analysis<a class="headerlink" href="#tutorial-kinetic-analysis" title="Permalink to this headline">¶</a></h1>
<p>First of all, lets load Pynoramix in our script or in a ipython session:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">pynoramix_beta</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Some basic notions on python will be assumed along this tutorial.</p>
<hr class="docutils" />
<div class="section" id="d-trajectories">
<h2>1D Trajectories<a class="headerlink" href="#d-trajectories" title="Permalink to this headline">¶</a></h2>
<p>Given a 1D trajectory , its kinetic analysis can be done taking advantage of the class <em>kinetic_1D_analysis</em>.
The following subsections are a description of how to deal with this class and the functions included.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The section XXX for the details of this function.</p>
</div>
<div class="section" id="loading-a-trajectory">
<h3>Loading a trajectory<a class="headerlink" href="#loading-a-trajectory" title="Permalink to this headline">¶</a></h3>
<p>Given a file, <a class="reference download internal" href="_downloads/traj.oup.gz"><tt class="xref download docutils literal"><span class="pre">traj.oup</span></tt></a>, with the 1D
trajectory in its second column, the class <em>kinetic_1D_analysis</em> can
be initialized:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">kin_test</span><span class="o">=</span><span class="n">kinetic_1D_analysis</span><span class="p">(</span><span class="s">&#39;traj.oup&#39;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Trajectory loaded: 999901 time steps</span>
</pre></div>
</div>
<p>Now, the trajectory is stored in the object kin_test:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [3]: </span><span class="k">print</span> <span class="s">&#39;Column&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">file_column</span><span class="p">,</span> <span class="s">&#39;in file&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">file_name</span>
<span class="go">Column 1 in file traj.oup</span>

<span class="gp">In [4]: </span><span class="k">print</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">num_particles</span><span class="p">,</span> <span class="s">&#39;particles  with&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">dimensions</span><span class="p">,</span> <span class="s">&#39;dimension&#39;</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="s">&#39;time steps.&#39;</span>
<span class="go">1 particles with 1 dimension: 999901 time steps.</span>

<span class="gp">In [5]: </span><span class="k">print</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">traj</span><span class="p">[:]</span>
<span class="go">[-0.91936072  0.74886578 -1.07525923 ..., -9.09667346 -8.40884264 -8.83918787]</span>
</pre></div>
</div>
<p>Since the trajectory is a numpy.ndarray, we can take adventage of its numpy intrinsic attributes and functions:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="k">print</span> <span class="s">&#39;Min.:&#39;</span><span class="p">,</span><span class="n">kin_test</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="s">&#39;   Mean:&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">,</span><span class="s">&#39;   Max.:&#39;</span><span class="p">,</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">Min.: -11.4344662381    Mean: -3.40808122446    Max.: 2.78106514618</span>
</pre></div>
</div>
<p>The histogram can be obtained with the following command:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">hxx</span><span class="p">,</span><span class="n">hyy</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">delta_x</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span><span class="n">segment</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">12.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pylab</span>

<span class="gp">In [9]: </span><span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hxx</span><span class="p">,</span><span class="n">hyy</span><span class="p">,</span><span class="s">&#39;b-&#39;</span><span class="p">)</span>
<span class="gr">Out[10]: </span><span class="p">[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x43277d0</span><span class="o">&gt;</span><span class="p">]</span>

<span class="gp">In [11]: </span><span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/histo_1D.png"><img alt="_images/histo_1D.png" src="_images/histo_1D.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
</div>
<div class="section" id="first-order-kinetic-model">
<h3>First order kinetic model<a class="headerlink" href="#first-order-kinetic-model" title="Permalink to this headline">¶</a></h3>
<p>At first glance the former distribution can be decompose in three
peaks, called macro-states since we know that this histogram is coming
from a dynamical system. Actually, the trajectory corresponds to the
projection onto an arbitrary coordinate of a langevin dynamics of a
particle embeded in a 2D potential.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/histo_color.png"><img alt="_images/histo_color.png" src="_images/histo_color.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>According to this first superficial analysis, the particle moves
through a landscape with 3 basins (green, orange, blue) separated by 2
barriers (green-orange and orange-blue). Thereby, the particle goes
from green to blue region bymeans of a necessary visit to the region orange.</p>
<p>A first order kinetic model can be computed with these three
states. The model should be written as a master equation where the
transition probabilities, or rates, between macrostates interplay to
mimic the macroscopical dynamical behavior observed in the experiment.</p>
<p>These transition probabilities are computed from the following trajectory:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">kin_test</span><span class="o">.</span><span class="n">traj</span><span class="p">[:]:</span>
<span class="go">   ...:     if xx &lt;=-5.5:</span>
<span class="go">   ...:          kin_test.traj_clusters.append(0)   # Green region</span>
<span class="go">   ...:     elif xx &lt;=-2.3:</span>
<span class="go">   ...:          kin_test.traj_clusters.append(1)   # Orange region</span>
<span class="go">   ...:     else:</span>
<span class="go">   ...:          kin_test.traj_clusters.append(2)   # Blue region</span>
<span class="go">   ...:</span>
</pre></div>
</div>
<p>Notice that the term &#8216;cluster&#8217; was used: a set of time steps belonging
to the same macrostate. This way the cluster labeled &#8216;0&#8217; corresponds
to region green, &#8216;1&#8217; to the orange one and &#8216;2&#8217; to the blue.  The
transition probabilities can be computed building the corresponding
kinetic network, or conformational space network. The trajectory is
mapped into a network where weighted nodes and directed links accounts to
the occupation of the clusters and the number of transitions among them.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">kin_test</span><span class="o">.</span><span class="n">kinetic_network</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Network:</span>
<span class="c"># 3 nodes</span>
<span class="c"># 9 links out</span>
<span class="c"># 999900.0 total weight nodes</span>
</pre></div>
</div>
<p>Before getting the transision probabilities, or rates, detailed
balance condition is impossed symmetrising the network.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="c"># Network:</span>
<span class="c"># 3 nodes</span>
<span class="c"># 9 links out</span>
<span class="c"># 1999800.0 total weight nodes</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The section XXX for the details of this function.</p>
</div>
<p>The network we have now is nothing but a kinetic model respresented as a graph. This way the master equations:</p>
<img src="_images/mathmpl/math-e4dd06b42d.png" class="center" /><p></p>
<img src="_images/mathmpl/math-acbbfe60df.png" class="center" /><p></p>
<img src="_images/mathmpl/math-8aae56b1b6.png" class="center" /><p>can be written with the transition probabilities:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="go">   ....:    ww=kin_test.network_clusters.node[ii].weight</span>
<span class="go">   ....:        for jj in range(3):</span>
<span class="go">   ....:            if ii!=jj :</span>
<span class="go">   ....:                print &#39;P&#39;+str(jj)+str(ii)+&#39;=&#39;, kin_test.network_clusters.node[ii].link[jj]/ww</span>
<span class="go">   ....:</span>
<span class="go">P10= 0.00134372002214</span>
<span class="go">P20= 0.000153059499211</span>
<span class="go">P01= 0.00190455529265</span>
<span class="go">P21= 0.0749385749386</span>
<span class="go">P02= 8.25724981733e-05</span>
<span class="go">P12= 0.0285230372469</span>
</pre></div>
</div>
<p>Where detailed balance condition, <img src="_images/mathmpl/math-c1fe9ce35a.png" style="position: relative; bottom: -11px"/>, is
fullfilled by construction. Thereby, the stationary solution of this
master equation is given by the occupation probabilities given found
as weights of nodes.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [11]: </span><span class="n">ww</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">weight</span>

<span class="gp">In [12]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="go">   ....:     print &#39;P&#39;+str(ii)+&#39;^s =&#39;, kin_test.network_clusters.node[ii].weight/ww</span>
<span class="go">   ....:</span>
<span class="go">P0^s = 0.28096459646</span>
<span class="go">P1^s = 0.198228822882</span>
<span class="go">P2^s = 0.520806580658</span>
</pre></div>
</div>
<p>We can now compare our kinetic model with the behavior observed in the
original trajectory.  This can be done attending to magnitudes as the
<em>mean dwell/life time</em> and its distribution or the <em>mean first passage
time</em> and its distribution.</p>
</div>
<div class="section" id="life-time-distribution">
<h3>Life time distribution<a class="headerlink" href="#life-time-distribution" title="Permalink to this headline">¶</a></h3>
<p>Up to here, in this tutorial we have built a kinetic model from a 1D
trajectory. Now the accuracy of the model can be checked with
observables as the life time of its macro-states.</p>
<p>First of all, the life time distribution of the 3 macro-states can be
computed from our clusters trajectory.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [13]: </span><span class="n">ltx_1</span><span class="p">,</span><span class="n">lty_1</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 16.3446993094 frames.</span>

<span class="gp">In [14]: </span><span class="n">ltx_2</span><span class="p">,</span><span class="n">lty_2</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 34.0213561056 frames.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This analysis was applied not to the trajectory found in the
file &#8216;traj.oup&#8217; but to a trajectory 10 times larges.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Function for further details.</p>
</div>
<p>The distributions can be fitted to exponential functions:
<img src="_images/mathmpl/math-e8c191130b.png" style="position: relative; bottom: -8px"/>. The next plot shows the fitting together with
the distributions, where approximately A=-0.008 and B=-9.763 for
cluster 1 (orange), and A=-0.026 and B=-7.311 for cluster 2 (blue).</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/lf_dist_bad.png"><img alt="_images/lf_dist_bad.png" src="_images/lf_dist_bad.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>We observe how the long time behavior fits to an exponential
distribution but <strong>many non expected short life events appear</strong>.</p>
<p>Now, we can compare with the life time distributions obtained by the
kinetic model although from the previous plot we can guess that our
clusters are not well defined. To this aim a random walker over the
kinetic network can be run according to the transition probabilities.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">bw_traj</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">brownian_walker</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">10000000</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">bw</span><span class="o">=</span><span class="n">kinetic_1D_analysis</span><span class="p">(</span><span class="n">bw_traj</span><span class="p">)</span>
<span class="c"># Trajectory loaded: 10000001 time steps</span>

<span class="gp">In [17]: </span><span class="n">ltbw_x_1</span><span class="p">,</span><span class="n">ltbw_y_1</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 16.2835161764 frames.</span>

<span class="gp">In [18]: </span><span class="n">ltbw_x_2</span><span class="p">,</span><span class="n">ltbw_y_2</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 34.1362159764 frames.</span>
</pre></div>
</div>
<p>This time the distributions and their exponential fits, A=-0.068 and B=-5.504 for
cluster 1 (orange) and A=-0.029 and B=-7.034 for cluster 2 (blue), shows a different behavior:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/lf_dist_model_bad.png"><img alt="_images/lf_dist_model_bad.png" src="_images/lf_dist_model_bad.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>We can see how, <strong>although the mean life time (in [13],[14] and
[17],[18]) are similar, the relaxations times are different from
those previously computed</strong>. Cluster 1 (orange) has a faster
relaxation than Cluster 2 (blue). It is up to the reader trying to
understand the origin of these different behaviors, even with the same
<em>mlt</em> (check section XXX to find some help).</p>
<p>These observations point to the possibility of having a bad kinetic
description of our system, but before showing how to do it better,
lets check another kinetic magnitude: the <em>first passage time distribution</em>.</p>
</div>
<div class="section" id="first-passage-time-distribution">
<h3>First Passage Time distribution<a class="headerlink" href="#first-passage-time-distribution" title="Permalink to this headline">¶</a></h3>
<p>Following the same strategy as in the previous section, we can compare
some distributions computed over the original clusters trajectory and
over its kinetic model. The first passage time distribution can be
computed to a certain state from a given state or from any one (<em>Global first passage time</em>).</p>
<p>The original clusters trajectory shows the following distributions for
this three different cases: the Global first passage time to cluster 2 (blue), from
cluster 0 (green) to cluster 2 and from cluster 1 (orange) to cluster 2.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [19]: </span><span class="n">fptx2</span><span class="p">,</span><span class="n">fpty2</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 700.403755073 frames.</span>

<span class="gp">In [20]: </span><span class="n">fptx02</span><span class="p">,</span><span class="n">fpty02</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 1175.03303483 frames.</span>

<span class="gp">In [21]: </span><span class="n">fptx12</span><span class="p">,</span><span class="n">fpty12</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 124.958081567 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fpt_bad_to2.png"><img alt="_images/fpt_bad_to2.png" src="_images/fpt_bad_to2.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>There are two things not expected in this plot. The <strong>short time
behavior looks anomalous</strong> and both distributions &#8216;1 to 2&#8217; and &#8216;0 to
2&#8217; should be bi-exponential. Since we made the first guest of having the
particle going from <strong>0 to 2</strong> with a necessary stay in cluster 1, this
distribution <strong>should be bi-exponential</strong>.</p>
<p>Now, we can compare with the first passage time distributions obtained
by the kinetic model. As it was done with the life time distributions,
a random walker over the kinetic network can be run according to the
transition probabilities.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [22]: </span><span class="n">bw_traj</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">brownian_walker</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">9999000</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="n">bw</span><span class="o">=</span><span class="n">kinetic_1D_analysis</span><span class="p">(</span><span class="n">bw_traj</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [24]: </span><span class="n">fptbwx2</span><span class="p">,</span> <span class="n">fptbwy2</span><span class="o">=</span> <span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 430.700895225 frames.</span>

<span class="gp">In [25]: </span><span class="n">fptbwx02</span><span class="p">,</span><span class="n">fptbwy02</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 751.240082388 frames.</span>

<span class="gp">In [26]: </span><span class="n">fptbwx12</span><span class="p">,</span><span class="n">fptbwy12</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 36.4134420305 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fpt_bad_to2_model.png"><img alt="_images/fpt_bad_to2_model.png" src="_images/fpt_bad_to2_model.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>This time we <strong>at least observe a bi-exponential</strong> behavior in the &#8216;1 to 2&#8217;
distribution in agreement with our first guess. But if we compare the
relaxation times, <strong>by simple inspection we conclude that distributions
are different</strong> from those obtained before from the clusters trajectory,
<strong>even the mean first passage times are different (in [19-21] and
[24-26])</strong>.</p>
<p>These analysis reinforce the idea of having a wrong analysis, the way
we have define the macro-states or cluster is not kinetically
consistent.  But before improving this analysis, let see one kinetic
observable more: what we have define as <em>first committed passage time</em>
(from the magnitude: committor probabilities)</p>
<p>It is up to the reader trying to understand the origin of these
different behaviors (check section XXX to find some help).</p>
</div>
<div class="section" id="first-committed-passage-time-distribution">
<h3>First Committed Passage Time distribution<a class="headerlink" href="#first-committed-passage-time-distribution" title="Permalink to this headline">¶</a></h3>
<p>In Physics of stochastic processes the <em>committor probability</em>,
<em>C_{a,b}</em>, is the probability of going from <em>b</em> to <em>a</em> without passing
through any other state. Based on this idea, we can compute the first
passage time from a state <em>b</em> to <em>a</em> with a requirement: passing or
not by other states.</p>
<p>In this tutorial we defined 3 macro-states or clusters from a 1D
trajectory (see above). And in our naive first analysis we made an
observation: to go from cluster 0 (green) to cluster 2 (blue), a visit
to cluster 1 (orange) is needed. For the sake of completeness lets
study the first passage time of going from 0 to 2 with and without
passing by cluster 1.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [27]: </span><span class="n">fcptx012</span><span class="p">,</span><span class="n">fcpty012</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 888.282178077 frames.</span>

<span class="gp">In [28]: </span><span class="n">fcptx0no12</span><span class="p">,</span><span class="n">fcpty0no12</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 861.446234118 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fcpt_bad_0to2.png"><img alt="_images/fcpt_bad_0to2.png" src="_images/fcpt_bad_0to2.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>The first passage time distribution of going from 0 to 2 without
passing by 1 it is not negligible as we assumed at the begining of
this tutorial just looking at the histogram.</p>
<p>The kinetic model shows also a similar behavior:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [29]: </span><span class="n">fcptbwx012</span><span class="p">,</span><span class="n">fcptbwy012</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 705.085477589 frames.</span>

<span class="gp">In [30]: </span><span class="n">fcptbwx0no12</span><span class="p">,</span><span class="n">fcptbwy0no12</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 682.339500433 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fcpt_bad_0to2_model.png"><img alt="_images/fcpt_bad_0to2_model.png" src="_images/fcpt_bad_0to2_model.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>But in this distributions, the life time of each stay in 0 is included
(as with the first passage time). Let see how in the next section we
can remove this the several independent trips origin by this fact.</p>
</div>
<div class="section" id="trip-time-distribution">
<h3>Trip Time distribution<a class="headerlink" href="#trip-time-distribution" title="Permalink to this headline">¶</a></h3>
<p>An other kinetic magnitude we can observe is the time distribution of
those segments of trajectory in between the stay of an initial cluster
or macro-state and the arrival to an other certain cluster. In this
case, unlike the first passage time, not every single step in the
initial cluster accounts for the distribution.</p>
<p>Lets check the trip time distribution from cluster 0 to cluster 2:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [31]: </span><span class="n">tt02x</span><span class="p">,</span><span class="n">tt02y</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">trip_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 295.365182591 frames.</span>

<span class="gp">In [32]: </span><span class="n">ttbw02x</span><span class="p">,</span><span class="n">ttbw02y</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">trip_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 33.0993065874 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/tt_bad_0to2_1.png"><img alt="_images/tt_bad_0to2_1.png" src="_images/tt_bad_0to2_1.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>Once more the kinetics observed in the model is different from what
can be computed in the trajectory. This observation points, once again,
to the fact of having a wrong built kinetic model.</p>
<p>While in the kinetic model the trip time looks like single
exponential, two different time scales (two different mechanisms
driving the particle from 0 to 1) are observed from the
trajectory. And this time is clear that the first fast decay
(steps&lt;=10) is shorter than the tipical life time of the intermediate
cluster 1 (mfpt1~=16). Again, we have evidences of straight 0 to 2
jumps not expected looking at the histogram. This can lead us to
invest our precious time trying to answer: How is this mechanism not
previously expected? But as we will see shortly, this fact it is just
an artifact. In addition, if we look in detail to the distribution
from the trajectory, the point at steps=1 does not take part of any of
the hypothetical mechanisms. Its value (tt(1)) is high enough to be
considered as noise. There is probably 3 different mechanisms, and
only the long time noisy tail makes sense for us given that its time
range is comparable with the life time distribution of the
intermediate cluster 1.</p>
<p>We could also argue that, if along the trip the initial state is
visited again, this stay is observed as part of the trip. If we want
to discard this events the option &#8216;no_return&#8217; is required:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [33]: </span><span class="n">tt02x</span><span class="p">,</span><span class="n">tt02y</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">trip_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 10.895183175 frames.</span>

<span class="gp">In [34]: </span><span class="n">ttbw02x</span><span class="p">,</span><span class="n">ttbw02y</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">trip_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 15.7288866345 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/tt_bad_0to2_2.png"><img alt="_images/tt_bad_0to2_2.png" src="_images/tt_bad_0to2_2.png" style="width: 560.0px; height: 420.0px;" /></a>
</div>
<p>The observations we can make are the same written above. The kinetic
model does not offer a good representation of the system. Regarding
the clusters trajectory, those jumps observed in just one time step
could be not expected straight transitions. But whats the first
exponential decay? Is it physically meaninful? The next section can
help us to enlight the question.</p>
</div>
<div class="section" id="committed-trip-time-distribution">
<h3>Committed Trip Time distribution<a class="headerlink" href="#committed-trip-time-distribution" title="Permalink to this headline">¶</a></h3>
<p>Similar as it was done for the <em>first committed passage time</em> (see
section XXX), we can also study committed trip distributions (see
section above).</p>
<p>Let see the trip time distribution of going from 0 to 2 passing by
cluster 1 or going straightforward without visiting the intermediate
cluster.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [35]: </span><span class="n">tt012x</span><span class="p">,</span><span class="n">tt012y</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">committed_trip_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 12.2196153846 frames.</span>

<span class="gp">In [36]: </span><span class="n">tt0no12x</span><span class="p">,</span><span class="n">tt0no12y</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">committed_trip_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 1.0 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/ctt_bad_0to2.png"><img alt="_images/ctt_bad_0to2.png" src="_images/ctt_bad_0to2.png" style="width: 560.0px; height: 420.0px;" /></a>
</div>
<p>It is clear now that the one step trips are straight transitions 0
to 1. We can now state that there are two time scales or mechanisms
over the path 0 to 1 to 2. We can again wonder what the origin of this
is. But as we will see later, there is not such misterious hidden
mechanism, not even logical transitions 0 to 2 with expected standard
stays in cluster 1.</p>
<p>This could not be unveiled just looking at our kinetic model, because
it is not properly built up.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [37]: </span><span class="n">ttbw012x</span><span class="p">,</span><span class="n">ttbw012y</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">committed_trip_time</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 17.24049217 frames.</span>

<span class="gp">In [38]: </span><span class="n">ttbw0no12x</span><span class="p">,</span><span class="n">ttbw0no12y</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">committed_trip_time</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">no_return</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 1.0 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/ctt_bad_0to2_model.png"><img alt="_images/ctt_bad_0to2_model.png" src="_images/ctt_bad_0to2_model.png" style="width: 560.0px; height: 420.0px;" /></a>
</div>
<p>Although there exist straight transitions from 0 to 2 in just one time
step, it is part of the same mechanism (exponential decay). The saving
frequency of the trajectory could be large enough to see straight
transitions when they briefly visited cluster 1.</p>
<p>It is up to the reader trying to understand the origin of these
different behaviors (in the next section some help can be found).</p>
</div>
<div class="section" id="accurate-kinetic-decomposition">
<span id="accurate-kin-dec"></span><h3>Accurate kinetic decomposition<a class="headerlink" href="#accurate-kinetic-decomposition" title="Permalink to this headline">¶</a></h3>
<p>The wrong description will change with the saving frequency, the good one no.</p>
<p>We have study along the tutorial a dynamical system which, according
to what was previously computed: we have 3 clusters with strange life
time distributions at short times, with strange first passage times,
and with direct transitions 0 to 1, and with two different mechanisms
of transitions 0 to 1 to 2.</p>
<p>But we have important doubts about our study: the kinetic model does
not reproduce the kinetics from the trajectory. The three cluster with
which the model was built are not well defined. Have a look to a piece
of trajectory to understand all the previous results and conclussions:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/traj123.png"><img alt="_images/traj123.png" src="_images/traj123.png" style="width: 560.0px; height: 420.0px;" /></a>
</div>
<p>The colors correspond to the three macro-states or clusters comming
from the barriers observed in the histogram (XXX).</p>
<p>It is up to the reader understanding now how the description obtained
before matches with the wrong definition of macro-states.</p>
<p>But the trajectory was a projection onto one dimmension of a dynamics
embedded in a larger dimensional space (2 in this case).  Before
propossing how to get a better description, a better kinetic model,
let see how the system behaves in the original 2 dimmensions:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/histo_2d.png"><img alt="_images/histo_2d.png" src="_images/histo_2d.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>The trajectory studied was the projection over the black axe. Knowing
now that we can define the three macro-states, clusters or basins of
attraction, with the barriers X=-5.5 and Y=5.5, we can rebuild the histogram:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/histo_color_good.png"><img alt="_images/histo_color_good.png" src="_images/histo_color_good.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>We understand now why, trying to understand the mechanisms of
transition 0 to 1 to 2 made no sense. Actually, there are no such
transitions, they were just an artifact.</p>
<p>With these three well defined clusters we can have a look now to the
kinetic magnitudes previously computed for the wrong model.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [11]: </span><span class="n">original_clusters</span><span class="o">=</span><span class="p">[]</span>

<span class="gp">In [12]: </span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
<span class="go">   ....:         if (ii[0]&lt;-5.50):</span>
<span class="go">   ....:             original_clusters.append(0)</span>
<span class="go">   ....:     elif (ii[1]&gt;5.50):</span>
<span class="go">   ....:             original_clusters.append(2)</span>
<span class="go">   ....:     else:</span>
<span class="go">   ....:             original_clusters.append(1)</span>
<span class="go">   ....:</span>

<span class="gp">In [16]: </span><span class="n">kin_test</span><span class="o">.</span><span class="n">traj_clusters</span><span class="o">=</span><span class="n">original_clusters</span>

<span class="gp">In [17]: </span><span class="n">kin_test</span><span class="o">.</span><span class="n">kinetic_network</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Network:</span>
<span class="c"># 3 nodes</span>
<span class="c"># 7 links out</span>
<span class="c"># 9999000.0 total weight nodes</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [59]: </span><span class="n">ltx_1</span><span class="p">,</span><span class="n">lty_1</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 4919.53658537 frames.</span>

<span class="gp">In [60]: </span><span class="n">ltx_2</span><span class="p">,</span><span class="n">lty_2</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">life_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean life time: 1247.09804915 frames.</span>
</pre></div>
</div>
<p>Long life times comparable with long traj.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [78]: </span><span class="n">fptx2</span><span class="p">,</span><span class="n">fpty2</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 3123.39159882 frames.</span>

<span class="gp">In [79]: </span><span class="n">fptx02</span><span class="p">,</span><span class="n">fpty02</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 995.111802212 frames.</span>

<span class="gp">In [80]: </span><span class="n">fptx12</span><span class="p">,</span><span class="n">fpty12</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 5863.2847721 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fpt_dist_good.png"><img alt="_images/fpt_dist_good.png" src="_images/fpt_dist_good.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>The order is different. I have to writte before that the kinetics was
absurdo. 0 to 2 was faster than 1 to 2 even with a barrier higher. It
is not possible since it has to go through 1. The times are also different.</p>
<p>Having an apparantly exponential behavior it is not saying that our kinetics is ok.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fpt_dist_good_model.png"><img alt="_images/fpt_dist_good_model.png" src="_images/fpt_dist_good_model.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<p>First committed_passage_time:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [136]: </span><span class="n">fcptx012</span><span class="p">,</span><span class="n">fcpty012</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 0.0 frames.</span>

<span class="gp">In [137]: </span><span class="n">fcptx0no12</span><span class="p">,</span><span class="n">fcpty0no12</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">first_committed_passage_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">commitment</span><span class="o">=</span><span class="p">[</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 995.111802212 frames.</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [138]: </span><span class="n">tt02x</span><span class="p">,</span><span class="n">tt02y</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">trip_time</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="s">&#39;clusters&#39;</span><span class="p">,</span><span class="n">from_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 1.0 frames.</span>
</pre></div>
</div>
<p>But can we define a good kinetic model without going to the original
2-dimensional trajectory? The next section shows how this can be done.</p>
<p>And to compare with the kinetic model coming from the 2D trajectory,
the <em>Global First Passage Time</em> distribution to cluster blue, and from
green or orange to blue, can be computed. With this aim we can create
a trajectory from a brownian walker over the kinetic network (see XXX).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="n">bw_traj</span><span class="o">=</span><span class="n">kin_test</span><span class="o">.</span><span class="n">network_clusters</span><span class="o">.</span><span class="n">brownian_walker</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">9999000</span><span class="p">)</span>
<span class="gp">In [17]: </span><span class="n">bw</span><span class="o">=</span><span class="n">kinetic_1D_analysis</span><span class="p">(</span><span class="n">bw_traj</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [18]: </span><span class="n">fptbwx2</span><span class="p">,</span> <span class="n">fptbwy2</span><span class="o">=</span> <span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">to_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 2128.84780171 frames.</span>

<span class="gp">In [19]: </span><span class="n">fptbwx02</span><span class="p">,</span><span class="n">fptbwy02</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 1060.31735473 frames.</span>

<span class="gp">In [20]: </span><span class="n">fptbwx12</span><span class="p">,</span><span class="n">fptbwy12</span><span class="o">=</span><span class="n">bw</span><span class="o">.</span><span class="n">first_passage_time</span><span class="p">(</span><span class="n">from_state</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">to_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c"># Mean first passage time: 3571.33044323 frames.</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/fpt_ganna.png"><img alt="_images/fpt_ganna.png" src="_images/fpt_ganna.png" style="width: 568.4px; height: 428.4px;" /></a>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The section XXX for the details of this function.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please cite the following reference if the method is used for a scientific publication: XXXXXXX</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_berezovska2012.html" title="Berezovska2012"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_networks.html" title="Tutorial Networks"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Diego Prada-Gracia.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>